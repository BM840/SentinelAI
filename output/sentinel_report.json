{
  "summary": {
    "total_findings": 39,
    "risk_score": 257,
    "risk_level": "CRITICAL RISK - Severe security flaws present. Do NOT deploy without remediation.",
    "severity_breakdown": {
      "CRITICAL": 14,
      "HIGH": 16,
      "MEDIUM": 6,
      "LOW": 3
    },
    "findings_by_agent": {
      "Agent A - Pattern Detector": 8,
      "Agent B - Auth Logic Auditor (LLM)": 5,
      "Agent C - Data Flow Analyzer": 1,
      "Agent E - Dependency Scanner": 12,
      "Agent F - Git History Scanner": 4,
      "Agent G - CORS & Headers Auditor": 6,
      "Agent H - Cryptography Auditor": 3
    },
    "files_scanned": [
      "demo_app\\app (1).py",
      "demo_app\\requirements.txt",
      "requirements.txt",
      "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git"
    ],
    "most_vulnerable_files": [
      {
        "file": "demo_app\\app (1).py",
        "count": 23
      },
      {
        "file": "requirements.txt",
        "count": 11
      },
      {
        "file": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
        "count": 4
      }
    ],
    "fixes_generated": 38,
    "files_patched": 1,
    "patched_file_paths": [
      "output\\patched\\FIXED_app (1).py"
    ],
    "scan_duration_seconds": 107.79,
    "target_path": "demo_app/"
  },
  "findings": [
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Hardcoded Secret",
      "description": "Potential hardcoded credential or secret detected on line 19.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app (1).py",
      "lineno": 19,
      "code_snippet": "ADMIN_TOKEN = \"admin-token-abc123xyz\"",
      "recommendation": "Use environment variables or a secrets manager (e.g., HashiCorp Vault, AWS Secrets Manager) instead of hardcoding secrets.",
      "cwe_id": "CWE-798"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Hardcoded Secret",
      "description": "Potential hardcoded credential or secret detected on line 20.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app (1).py",
      "lineno": 20,
      "code_snippet": "STRIPE_SECRET = \"sk_live_4eKoV8mNpQrL92xZ\"",
      "recommendation": "Use environment variables or a secrets manager (e.g., HashiCorp Vault, AWS Secrets Manager) instead of hardcoding secrets.",
      "cwe_id": "CWE-798"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Hardcoded Secret",
      "description": "Potential hardcoded credential or secret detected on line 21.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app (1).py",
      "lineno": 21,
      "code_snippet": "SENDGRID_API_KEY = \"SG.xK9mP2nQvL8rT5wY\"",
      "recommendation": "Use environment variables or a secrets manager (e.g., HashiCorp Vault, AWS Secrets Manager) instead of hardcoding secrets.",
      "cwe_id": "CWE-798"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Use of eval() Detected",
      "description": "eval() on line 318 can execute arbitrary code if user input is passed.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app (1).py",
      "lineno": 318,
      "code_snippet": "result     = eval(expression)",
      "recommendation": "Avoid eval() entirely. Use safe alternatives like ast.literal_eval() for data parsing, or redesign the logic.",
      "cwe_id": "CWE-95"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "SQL Injection Risk - String Concatenation in Query",
      "description": "Line 200 appears to build a SQL query via string concatenation or f-string, which is vulnerable to SQL injection.",
      "severity": "HIGH",
      "filepath": "demo_app\\app (1).py",
      "lineno": 200,
      "code_snippet": "\"SELECT username, email FROM users WHERE username LIKE '%\" + query + \"%'\"",
      "recommendation": "Use parameterized queries or an ORM (e.g., SQLAlchemy). Never concatenate user input directly into SQL.",
      "cwe_id": "CWE-89"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "SQL Injection Risk - String Concatenation in Query",
      "description": "Line 271 appears to build a SQL query via string concatenation or f-string, which is vulnerable to SQL injection.",
      "severity": "HIGH",
      "filepath": "demo_app\\app (1).py",
      "lineno": 271,
      "code_snippet": "users = conn.execute(\"SELECT * FROM users\").fetchall()",
      "recommendation": "Use parameterized queries or an ORM (e.g., SQLAlchemy). Never concatenate user input directly into SQL.",
      "cwe_id": "CWE-89"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Debug Mode Enabled",
      "description": "Debug mode is enabled on line 23. In production, this exposes stack traces, internal state, and may enable the interactive debugger.",
      "severity": "MEDIUM",
      "filepath": "demo_app\\app (1).py",
      "lineno": 23,
      "code_snippet": "app.config[\"DEBUG\"] = True",
      "recommendation": "Disable debug mode in production. Use environment-based configuration (e.g., DEBUG = os.getenv('DEBUG', 'False') == 'True').",
      "cwe_id": "CWE-215"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Debug Mode Enabled",
      "description": "Debug mode is enabled on line 371. In production, this exposes stack traces, internal state, and may enable the interactive debugger.",
      "severity": "MEDIUM",
      "filepath": "demo_app\\app (1).py",
      "lineno": 371,
      "code_snippet": "app.run(debug=True, host=\"0.0.0.0\", port=5000)",
      "recommendation": "Disable debug mode in production. Use environment-based configuration (e.g., DEBUG = os.getenv('DEBUG', 'False') == 'True').",
      "cwe_id": "CWE-215"
    },
    {
      "agent": "Agent B - Auth Logic Auditor (LLM)",
      "title": "SQL Injection",
      "description": "The function directly interpolates user input into an SQL statement without sanitization, allowing for potential injection attacks.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app (1).py",
      "lineno": 35,
      "code_snippet": "def init_db():\n    conn = get_db()\n    conn.execute(\"\"\"\n        CREATE TABLE IF NOT EXISTS users (\n            id INTEGER PRIMARY KEY,\n            username TEXT UNIQUE NOT NULL,\n            password TEXT NOT NULL,\n            email TEXT,\n            balance REAL DEFAULT 1000.0,\n            role TEXT...",
      "recommendation": "Use parameterized queries to prevent direct execution of malicious SQL code within the database query string. Replace raw SQL with a safe method like `cursor.execute(sql_query, params)`.",
      "cwe_id": "CWE-847"
    },
    {
      "agent": "Agent B - Auth Logic Auditor (LLM)",
      "title": "Weak Hashing Algorithm",
      "description": "The function uses MD5 for password hashing which is considered insecure and vulnerable to brute force attacks.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app (1).py",
      "lineno": 62,
      "code_snippet": "def hash_password(password):\n    return hashlib.md5(password.encode()).hexdigest()",
      "recommendation": "Replace the use of `hashlib.md5` with a more secure algorithm like bcrypt or Argon2, as they are designed specifically for password storage and include built-in salting mechanisms.",
      "cwe_id": "CWE-346"
    },
    {
      "agent": "Agent B - Auth Logic Auditor (LLM)",
      "title": "Session Hijacking Risk",
      "description": "The function does not verify the integrity of session tokens, allowing for potential hijacking if a user's cookies are stolen.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app (1).py",
      "lineno": 66,
      "code_snippet": "def login_required(f):\n    @wraps(f)\n    def decorated(*args, **kwargs):\n        if \"user_id\" not in session:\n            return jsonify({\"error\": \"Authentication required\"}), 401\n        return f(*args, **kwargs)\n    return decorated",
      "recommendation": "Implement token binding or use secure and HttpOnly flags on sessions to mitigate against cross-site request forgery (CSRF) attacks where an attacker can steal session cookies from the victim\u2019s browser.",
      "cwe_id": "CWE-739"
    },
    {
      "agent": "Agent B - Auth Logic Auditor (LLM)",
      "title": "Password Hash Comparison Error Handling",
      "description": "The function compares plain passwords with hashed ones without handling potential exceptions, which could lead to information leakage or denial of service.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app (1).py",
      "lineno": 106,
      "code_snippet": "def login():\n    data     = request.get_json()\n    username = data.get(\"username\", \"\")\n    password = data.get(\"password\", \"\")\n\n    conn  = get_db()\n    query = \"SELECT * FROM users WHERE username = '%s'\" % username\n    user  = conn.execute(query).fetchone()\n    conn.close()\n\n    if user and user[\"p...",
      "recommendation": "Implement proper exception handling around the password comparison and ensure that no sensitive error details are exposed in case of a failed login attempt due to incorrect credentials.",
      "cwe_id": "CWE-269"
    },
    {
      "agent": "Agent B - Auth Logic Auditor (LLM)",
      "title": "Sensitive Data Exposure via Email Content",
      "description": "The function sends the reset token directly within an email body, which could be read by unauthorized parties if intercepted.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app (1).py",
      "lineno": 132,
      "code_snippet": "def forgot_password():\n    data  = request.get_json()\n    email = data.get(\"email\", \"\")\n\n    token = generate_reset_token(email)\n\n    # Send reset email via external service\n    response = requests.post(\n        \"https://api.sendgrid.com/v3/mail/send\",\n        headers={\"Authorization\": f\"Bearer {SEN...",
      "recommendation": "Ensure sensitive data like tokens are not included in plain text emails and consider using a secure channel for sending such information or implementing additional verification steps to confirm legitimate requests before processing them further.",
      "cwe_id": "CWE-269"
    },
    {
      "agent": "Agent C - Data Flow Analyzer",
      "title": "Unsanitized User Input Reaches conn.execute()",
      "description": "In function 'search_users', user-controlled variable(s) ['query'] flow directly into 'conn.execute()' without apparent sanitization.",
      "severity": "HIGH",
      "filepath": "demo_app\\app (1).py",
      "lineno": 199,
      "code_snippet": "conn.execute(\"SELECT username, email FROM users WHERE username LIKE '%\" + query + \"%'\")",
      "recommendation": "Sanitize and validate all user-supplied data before passing to database queries, OS commands, or eval-like functions. Use parameterized queries for SQL.",
      "cwe_id": "CWE-20"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: Pillow",
      "description": "Pillow==9.0.0 may be affected by CVE-2022-22817: Pillow PIL.ImageMath.eval allows arbitrary code execution.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\requirements.txt",
      "lineno": 12,
      "code_snippet": "Pillow==9.0.0",
      "recommendation": "Upgrade Pillow to the latest patched version. Run: pip install --upgrade Pillow",
      "cwe_id": "CWE-1035"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: flask",
      "description": "flask==0.12.3 may be affected by CVE-2018-1000656: Flask before 0.12.5 is vulnerable to Denial of Service via malicious JSON data.",
      "severity": "HIGH",
      "filepath": "requirements.txt",
      "lineno": 1,
      "code_snippet": "flask==0.12.3",
      "recommendation": "Upgrade flask to the latest patched version. Run: pip install --upgrade flask",
      "cwe_id": "CWE-1035"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: django",
      "description": "django==2.2.0 may be affected by CVE-2022-28346: Django SQL injection vulnerability in QuerySet.annotate().",
      "severity": "CRITICAL",
      "filepath": "requirements.txt",
      "lineno": 2,
      "code_snippet": "django==2.2.0",
      "recommendation": "Upgrade django to the latest patched version. Run: pip install --upgrade django",
      "cwe_id": "CWE-1035"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: requests",
      "description": "requests==2.18.0 may be affected by CVE-2018-18074: Requests library sends HTTP Authorization header to redirected hosts.",
      "severity": "MEDIUM",
      "filepath": "requirements.txt",
      "lineno": 3,
      "code_snippet": "requests==2.18.0",
      "recommendation": "Upgrade requests to the latest patched version. Run: pip install --upgrade requests",
      "cwe_id": "CWE-1035"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: pillow",
      "description": "pillow==8.0.0 may be affected by CVE-2022-22817: Pillow PIL.ImageMath.eval allows arbitrary code execution.",
      "severity": "CRITICAL",
      "filepath": "requirements.txt",
      "lineno": 4,
      "code_snippet": "pillow==8.0.0",
      "recommendation": "Upgrade pillow to the latest patched version. Run: pip install --upgrade pillow",
      "cwe_id": "CWE-1035"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: pyyaml",
      "description": "pyyaml==5.3 may be affected by CVE-2020-14343: PyYAML arbitrary code execution via yaml.load() without Loader.",
      "severity": "CRITICAL",
      "filepath": "requirements.txt",
      "lineno": 5,
      "code_snippet": "pyyaml==5.3",
      "recommendation": "Upgrade pyyaml to the latest patched version. Run: pip install --upgrade pyyaml",
      "cwe_id": "CWE-1035"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: sqlalchemy",
      "description": "sqlalchemy==1.3.0 may be affected by CVE-2019-7164: SQLAlchemy SQL injection via order_by() parameter.",
      "severity": "HIGH",
      "filepath": "requirements.txt",
      "lineno": 6,
      "code_snippet": "sqlalchemy==1.3.0",
      "recommendation": "Upgrade sqlalchemy to the latest patched version. Run: pip install --upgrade sqlalchemy",
      "cwe_id": "CWE-1035"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: jinja2",
      "description": "jinja2==2.10.0 may be affected by CVE-2020-28493: Jinja2 ReDoS vulnerability in urlize filter.",
      "severity": "MEDIUM",
      "filepath": "requirements.txt",
      "lineno": 7,
      "code_snippet": "jinja2==2.10.0",
      "recommendation": "Upgrade jinja2 to the latest patched version. Run: pip install --upgrade jinja2",
      "cwe_id": "CWE-1035"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: werkzeug",
      "description": "werkzeug==1.0.0 may be affected by CVE-2023-25577: Werkzeug multipart data parsing DoS vulnerability.",
      "severity": "HIGH",
      "filepath": "requirements.txt",
      "lineno": 8,
      "code_snippet": "werkzeug==1.0.0",
      "recommendation": "Upgrade werkzeug to the latest patched version. Run: pip install --upgrade werkzeug",
      "cwe_id": "CWE-1035"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: numpy",
      "description": "numpy may be affected by CVE-2019-6446: NumPy pickle deserialization vulnerability via np.load().",
      "severity": "HIGH",
      "filepath": "requirements.txt",
      "lineno": 9,
      "code_snippet": "numpy",
      "recommendation": "Upgrade numpy to the latest patched version. Run: pip install --upgrade numpy",
      "cwe_id": "CWE-1035"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Unpinned Dependency: numpy",
      "description": "numpy has no version pinned. Unpinned dependencies can introduce breaking changes or vulnerabilities automatically.",
      "severity": "LOW",
      "filepath": "requirements.txt",
      "lineno": 9,
      "code_snippet": "numpy",
      "recommendation": "Pin to a specific version: numpy==<version>. Use 'pip freeze' to get current versions.",
      "cwe_id": "CWE-1104"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: urllib3",
      "description": "urllib3==1.25.0 may be affected by CVE-2021-33503: urllib3 ReDoS vulnerability in URL parsing.",
      "severity": "HIGH",
      "filepath": "requirements.txt",
      "lineno": 10,
      "code_snippet": "urllib3==1.25.0",
      "recommendation": "Upgrade urllib3 to the latest patched version. Run: pip install --upgrade urllib3",
      "cwe_id": "CWE-1035"
    },
    {
      "agent": "Agent F - Git History Scanner",
      "title": "PostgreSQL Connection String with Credentials in Git History",
      "description": "A potential secret was found in commit b1cd13ae (2026-02-24) by BM840. Even if deleted from current code, this secret remains accessible in git history to anyone with repo access.",
      "severity": "HIGH",
      "filepath": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
      "lineno": null,
      "code_snippet": "Commit: b1cd13ae | initial commit\n(r'postgres://[^:]+:[^@]+@',",
      "recommendation": "1. Rotate/revoke the exposed secret immediately.\n2. Use 'git filter-repo' or BFG Repo Cleaner to purge from history.\n3. Force-push the cleaned history.\n4. Use environment variables for all secrets going forward.",
      "cwe_id": "CWE-312"
    },
    {
      "agent": "Agent F - Git History Scanner",
      "title": "OpenAI API Key in Git History",
      "description": "A potential secret was found in commit b1cd13ae (2026-02-24) by BM840. Even if deleted from current code, this secret remains accessible in git history to anyone with repo access.",
      "severity": "HIGH",
      "filepath": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
      "lineno": null,
      "code_snippet": "Commit: b1cd13ae | initial commit\n\"code_snippet\": \"API_KEY = \\\"sk-abc123xyz789hardcoded\\\"\",",
      "recommendation": "1. Rotate/revoke the exposed secret immediately.\n2. Use 'git filter-repo' or BFG Repo Cleaner to purge from history.\n3. Force-push the cleaned history.\n4. Use environment variables for all secrets going forward.",
      "cwe_id": "CWE-312"
    },
    {
      "agent": "Agent F - Git History Scanner",
      "title": "Password in Git History",
      "description": "A potential secret was found in commit b1cd13ae (2026-02-24) by BM840. Even if deleted from current code, this secret remains accessible in git history to anyone with repo access.",
      "severity": "HIGH",
      "filepath": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
      "lineno": null,
      "code_snippet": "Commit: b1cd13ae | initial commit\nDB_PASSWORD = \"admin123\"",
      "recommendation": "1. Rotate/revoke the exposed secret immediately.\n2. Use 'git filter-repo' or BFG Repo Cleaner to purge from history.\n3. Force-push the cleaned history.\n4. Use environment variables for all secrets going forward.",
      "cwe_id": "CWE-312"
    },
    {
      "agent": "Agent F - Git History Scanner",
      "title": "API Key in Git History",
      "description": "A potential secret was found in commit b1cd13ae (2026-02-24) by BM840. Even if deleted from current code, this secret remains accessible in git history to anyone with repo access.",
      "severity": "HIGH",
      "filepath": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
      "lineno": null,
      "code_snippet": "Commit: b1cd13ae | initial commit\nAPI_KEY = \"sk-abc123xyz789hardcoded\"",
      "recommendation": "1. Rotate/revoke the exposed secret immediately.\n2. Use 'git filter-repo' or BFG Repo Cleaner to purge from history.\n3. Force-push the cleaned history.\n4. Use environment variables for all secrets going forward.",
      "cwe_id": "CWE-312"
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: X-Content-Type-Options",
      "description": "The 'X-Content-Type-Options' security header is not set in this file. Prevents MIME-type sniffing attacks.",
      "severity": "MEDIUM",
      "filepath": "demo_app\\app (1).py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add: response.headers['X-Content-Type-Options'] = 'nosniff'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-Content-Type-Options'] = '...'\n    return response",
      "cwe_id": "CWE-693"
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: X-Frame-Options",
      "description": "The 'X-Frame-Options' security header is not set in this file. Prevents clickjacking by controlling iframe embedding.",
      "severity": "MEDIUM",
      "filepath": "demo_app\\app (1).py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add: response.headers['X-Frame-Options'] = 'DENY' or 'SAMEORIGIN'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-Frame-Options'] = '...'\n    return response",
      "cwe_id": "CWE-1021"
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: Strict-Transport-Security",
      "description": "The 'Strict-Transport-Security' security header is not set in this file. Enforces HTTPS connections (HSTS). Without this, users can be downgraded to HTTP.",
      "severity": "HIGH",
      "filepath": "demo_app\\app (1).py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add: response.headers['Strict-Transport-Security'] = 'max-age=31536000; includeSubDomains'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['Strict-Transport-Security'] = '...'\n    return response",
      "cwe_id": "CWE-319"
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: Content-Security-Policy",
      "description": "The 'Content-Security-Policy' security header is not set in this file. Controls which resources the browser can load, preventing XSS attacks.",
      "severity": "HIGH",
      "filepath": "demo_app\\app (1).py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add a Content-Security-Policy header to restrict script/style sources.\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['Content-Security-Policy'] = '...'\n    return response",
      "cwe_id": "CWE-79"
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: X-XSS-Protection",
      "description": "The 'X-XSS-Protection' security header is not set in this file. Enables browser XSS filter (legacy browsers).",
      "severity": "LOW",
      "filepath": "demo_app\\app (1).py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add: response.headers['X-XSS-Protection'] = '1; mode=block'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-XSS-Protection'] = '...'\n    return response",
      "cwe_id": "CWE-79"
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: Referrer-Policy",
      "description": "The 'Referrer-Policy' security header is not set in this file. Controls how much referrer info is sent with requests.",
      "severity": "LOW",
      "filepath": "demo_app\\app (1).py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add: response.headers['Referrer-Policy'] = 'strict-origin-when-cross-origin'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['Referrer-Policy'] = '...'\n    return response",
      "cwe_id": "CWE-200"
    },
    {
      "agent": "Agent H - Cryptography Auditor",
      "title": "Weak Hash Algorithm: MD5",
      "description": "MD5 is cryptographically broken and should not be used for security purposes.",
      "severity": "HIGH",
      "filepath": "demo_app\\app (1).py",
      "lineno": 63,
      "code_snippet": "return hashlib.md5(password.encode()).hexdigest()",
      "recommendation": "Replace MD5 with SHA-256 or SHA-3 for general hashing.\nFor passwords, use bcrypt, argon2, or PBKDF2 via passlib:\n  from passlib.hash import bcrypt\n  hashed = bcrypt.hash(password)",
      "cwe_id": "CWE-327"
    },
    {
      "agent": "Agent H - Cryptography Auditor",
      "title": "Insecure Random - random.randint()",
      "description": "random.randint() is not cryptographically secure. Do not use for tokens, keys, or passwords. [[!] Security-sensitive context detected]",
      "severity": "HIGH",
      "filepath": "demo_app\\app (1).py",
      "lineno": 76,
      "code_snippet": "token = str(random.randint(100000, 999999))",
      "recommendation": "Use the 'secrets' module for cryptographically secure randomness:\n  import secrets\n  token = secrets.token_hex(32)       # random hex string\n  token = secrets.token_urlsafe(32)   # URL-safe token\n  choice = secrets.choice(my_list)    # secure random choice",
      "cwe_id": "CWE-338"
    },
    {
      "agent": "Agent H - Cryptography Auditor",
      "title": "SSL Certificate Verification Disabled",
      "description": "Disabling SSL certificate verification exposes the app to man-in-the-middle attacks.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app (1).py",
      "lineno": 147,
      "code_snippet": "verify=False",
      "recommendation": "Use ssl.PROTOCOL_TLS_CLIENT with ssl.create_default_context():\n  import ssl\n  ctx = ssl.create_default_context()\n  # This enforces TLS 1.2+, certificate verification, and hostname checking",
      "cwe_id": "CWE-295"
    }
  ]
}