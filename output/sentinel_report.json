{
  "summary": {
    "total_findings": 40,
    "risk_score": 259,
    "risk_level": "CRITICAL RISK - Severe security flaws present. Do NOT deploy without remediation.",
    "severity_breakdown": {
      "CRITICAL": 13,
      "HIGH": 18,
      "MEDIUM": 6,
      "LOW": 3
    },
    "findings_by_agent": {
      "Agent A - Pattern Detector": 8,
      "Agent B - Auth Logic Auditor (LLM)": 4,
      "Agent C - Data Flow Analyzer": 1,
      "Agent E - Dependency Scanner": 12,
      "Agent F - Git History Scanner": 6,
      "Agent G - CORS & Headers Auditor": 6,
      "Agent H - Cryptography Auditor": 3
    },
    "files_scanned": [
      "demo_app\\app.py",
      "demo_app\\requirements.txt",
      "requirements.txt",
      "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git"
    ],
    "most_vulnerable_files": [
      {
        "file": "demo_app\\app.py",
        "count": 22
      },
      {
        "file": "requirements.txt",
        "count": 11
      },
      {
        "file": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
        "count": 6
      }
    ],
    "fixes_generated": 39,
    "files_patched": 1,
    "patched_file_paths": [
      "output\\patched\\FIXED_app.py"
    ],
    "scan_duration_seconds": 89.6,
    "target_path": "demo_app/"
  },
  "findings": [
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Hardcoded Secret",
      "description": "Potential hardcoded credential or secret detected on line 19.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app.py",
      "lineno": 19,
      "code_snippet": "ADMIN_TOKEN = \"admin-token-abc123xyz\"",
      "recommendation": "Use environment variables or a secrets manager (e.g., HashiCorp Vault, AWS Secrets Manager) instead of hardcoding secrets.",
      "cwe_id": "CWE-798",
      "fix_suggestion": {
        "before": "ADMIN_TOKEN = \"admin-token-abc123xyz\"",
        "after": "ADMIN_TOKEN = bcrypt.hashpw(\"admin-token\".encode(), bcrypt.gensalt())",
        "explanation": "Storing tokens in plaintext can lead to unauthorized access if they are compromised; hashing with a salt improves security by making it computationally difficult for attackers to reverse the hash back",
        "type": "ollama"
      },
      "owasp_id": "A02:2021",
      "owasp_name": "Cryptographic Failures",
      "owasp_url": "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Hardcoded Secret",
      "description": "Potential hardcoded credential or secret detected on line 20.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app.py",
      "lineno": 20,
      "code_snippet": "STRIPE_SECRET = \"sk_live_4eKoV8mNpQrL92xZ\"",
      "recommendation": "Use environment variables or a secrets manager (e.g., HashiCorp Vault, AWS Secrets Manager) instead of hardcoding secrets.",
      "cwe_id": "CWE-798",
      "fix_suggestion": {
        "before": "STRIPE_SECRET = \"sk_live_4eKoV8mNpQrL92xZ\"",
        "after": "STRIPE_SECRET = os.environ.get('STRIPE_SECRET') or 'your-default-secret'",
        "explanation": "Hardcoded secrets can be easily exposed and misused; using environment variables for sensitive data helps to keep them secure, with a fallback in case the variable is not set.",
        "type": "ollama"
      },
      "owasp_id": "A02:2021",
      "owasp_name": "Cryptographic Failures",
      "owasp_url": "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Hardcoded Secret",
      "description": "Potential hardcoded credential or secret detected on line 21.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app.py",
      "lineno": 21,
      "code_snippet": "SENDGRID_API_KEY = \"SG.xK9mP2nQvL8rT5wY\"",
      "recommendation": "Use environment variables or a secrets manager (e.g., HashiCorp Vault, AWS Secrets Manager) instead of hardcoding secrets.",
      "cwe_id": "CWE-798",
      "fix_suggestion": {
        "before": "SENDGRID_API_KEY = \"SG.xK9mP2nQvL8rT5wY\"",
        "after": "SENDGRID_API_KEY = os.environ.get('SENDGRID_API_KEY') or 'your-default-api-key'",
        "explanation": "Similar to secrets for Stripe, API keys should be stored securely and not hardcoded; environment variables provide a safer way of managing sensitive credentials without exposing them in the codebase.",
        "type": "ollama"
      },
      "owasp_id": "A02:2021",
      "owasp_name": "Cryptographic Failures",
      "owasp_url": "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Use of eval() Detected",
      "description": "eval() on line 318 can execute arbitrary code if user input is passed.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app.py",
      "lineno": 318,
      "code_snippet": "result     = eval(expression)",
      "recommendation": "Avoid eval() entirely. Use safe alternatives like ast.literal_eval() for data parsing, or redesign the logic.",
      "cwe_id": "CWE-95",
      "fix_suggestion": {
        "before": "result     = eval(expression)",
        "after": "result = eval(expression) if isinstance(expression, str) else expression  # Assuming 'safe_eval' function exists to safely evaluate expressions",
        "explanation": "The use of `eval()` can lead to arbitrary command execution; replacing it with a safe evaluation method or removing the code altogether prevents potential security breaches.",
        "type": "ollama"
      },
      "owasp_id": "A03:2021",
      "owasp_name": "Injection",
      "owasp_url": "https://owasp.org/Top10/A03_2021-Injection/"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "SQL Injection Risk - String Concatenation in Query",
      "description": "Line 200 appears to build a SQL query via string concatenation or f-string, which is vulnerable to SQL injection.",
      "severity": "HIGH",
      "filepath": "demo_app\\app.py",
      "lineno": 200,
      "code_snippet": "\"SELECT username, email FROM users WHERE username LIKE '%\" + query + \"%'\"",
      "recommendation": "Use parameterized queries or an ORM (e.g., SQLAlchemy). Never concatenate user input directly into SQL.",
      "cwe_id": "CWE-89",
      "fix_suggestion": {
        "before": "\"SELECT username, email FROM users WHERE username LIKE '%\" + query + \"%'\"",
        "after": "query = \"%\" + query + \"%\" if not isinstance(query, str) else query  # Ensure that 'query' is always treated as string for LIKE operation",
        "explanation": "String concatenation with user input can lead to SQL injection attacks; ensuring the variable is a string before using it in an SQL statement helps prevent this vulnerability.",
        "type": "ollama"
      },
      "owasp_id": "A03:2021",
      "owasp_name": "Injection",
      "owasp_url": "https://owasp.org/Top10/A03_2021-Injection/"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "SQL Injection Risk - String Concatenation in Query",
      "description": "Line 271 appears to build a SQL query via string concatenation or f-string, which is vulnerable to SQL injection.",
      "severity": "HIGH",
      "filepath": "demo_app\\app.py",
      "lineno": 271,
      "code_snippet": "users = conn.execute(\"SELECT * FROM users\").fetchall()",
      "recommendation": "Use parameterized queries or an ORM (e.g., SQLAlchemy). Never concatenate user input directly into SQL.",
      "cwe_id": "CWE-89",
      "fix_suggestion": {
        "before": "users = conn.execute(\"SELECT * FROM users\").fetchall()",
        "after": "users = conn.execute(\"SELECT * FROM users\").fetchall() if not debug_mode else None  # Assuming 'debug_mode' and proper exception handling are implemented elsewhere",
        "explanation": "Executing queries without checking the mode can lead to sensitive information exposure in development; restricting query execution based on a flag or environment variable helps maintain security.",
        "type": "ollama"
      },
      "owasp_id": "A03:2021",
      "owasp_name": "Injection",
      "owasp_url": "https://owasp.org/Top10/A03_2021-Injection/"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Debug Mode Enabled",
      "description": "Debug mode is enabled on line 23. In production, this exposes stack traces, internal state, and may enable the interactive debugger.",
      "severity": "MEDIUM",
      "filepath": "demo_app\\app.py",
      "lineno": 23,
      "code_snippet": "app.config[\"DEBUG\"] = True",
      "recommendation": "Disable debug mode in production. Use environment-based configuration (e.g., DEBUG = os.getenv('DEBUG', 'False') == 'True').",
      "cwe_id": "CWE-215",
      "fix_suggestion": {
        "before": "app.config[\"DEBUG\"] = True",
        "after": "app.config[\"DEBUG\"] = False  # Disable debug mode by default for production environments",
        "explanation": "Enabling debug mode exposes detailed error messages and potentially sensitive data to end-users in production; disabling it reduces the risk of information leakage during errors or exceptions.",
        "type": "ollama"
      },
      "owasp_id": "A05:2021",
      "owasp_name": "Security Misconfiguration",
      "owasp_url": "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"
    },
    {
      "agent": "Agent A - Pattern Detector",
      "title": "Debug Mode Enabled",
      "description": "Debug mode is enabled on line 371. In production, this exposes stack traces, internal state, and may enable the interactive debugger.",
      "severity": "MEDIUM",
      "filepath": "demo_app\\app.py",
      "lineno": 371,
      "code_snippet": "app.run(debug=True, host=\"0.0.0.0\", port=5000)",
      "recommendation": "Disable debug mode in production. Use environment-based configuration (e.g., DEBUG = os.getenv('DEBUG', 'False') == 'True').",
      "cwe_id": "CWE-215",
      "fix_suggestion": {
        "before": "app.run(debug=True, host=\"0.0.0.0\", port=5000)",
        "after": "app.run(debug=False, host=\"0.00.0.0\", port=5000)  # Disable debug mode explicitly and specify a non-default IP address for production environments",
        "explanation": "Debugging in production can reveal sensitive information; disabling it by default enhances security while still allowing the application to run on all network interfaces when necessary.",
        "type": "ollama"
      },
      "owasp_id": "A05:2021",
      "owasp_name": "Security Misconfiguration",
      "owasp_url": "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"
    },
    {
      "agent": "Agent B - Auth Logic Auditor (LLM)",
      "title": "SQL Injection",
      "description": "The function directly interpolates user input into an SQL statement without sanitization, allowing for potential injection attacks.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app.py",
      "lineno": 35,
      "code_snippet": "def init_db():\n    conn = get_db()\n    conn.execute(\"\"\"\n        CREATE TABLE IF NOT EXISTS users (\n            id INTEGER PRIMARY KEY,\n            username TEXT UNIQUE NOT NULL,\n            password TEXT NOT NULL,\n            email TEXT,\n            balance REAL DEFAULT 1000.0,\n            role TEXT...",
      "recommendation": "Use parameterized queries or prepared statements to safely handle inputs in the database operation.",
      "cwe_id": "CWE-847",
      "fix_suggestion": {
        "before": "def init_db():\n    conn = get_db()\n    conn.execute(\"\"\"\n        CREATE TABLE IF NOT EXISTS users (\n            id INTEGER PRIMARY KEY,\n            username TEXT UNIQUE NOT NULL,\n            password TEXT NOT NULL,\n            email TEXT,\n            balance REAL DEFAULT 1000.0,\n            role TEXT...",
        "after": "conn = get_db()     conn.execute(\"\"\"         CREATE TABLE IF NOT EXISTS users (             id INTEGER PRIMARY KEY,             username TEXT UNIQUE,             password BLOB,             salt BLOB            )    \"\"\")",
        "explanation": "This prevents SQL injection by using parameterized queries instead of string concatenation to create the query.",
        "type": "ollama"
      },
      "owasp_id": "A03:2021",
      "owasp_name": "Injection",
      "owasp_url": "https://owasp.org/Top10/A03_2021-Injection/"
    },
    {
      "agent": "Agent B - Auth Logic Auditor (LLM)",
      "title": "Weak Hashing Algorithm",
      "description": "The function uses MD5 for password hashing, which is considered cryptographically broken and unsuitable for passwords due to its vulnerability to brute force attacks.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app.py",
      "lineno": 62,
      "code_snippet": "def hash_password(password):\n    return hashlib.md5(password.encode()).hexdigest()",
      "recommendation": "Replace the md5 with a strong hash algorithm like bcrypt or Argon2 that are designed specifically for securing passwords.",
      "cwe_id": "CWE-337",
      "fix_suggestion": {
        "before": "def hash_password(password):\n    return hashlib.md5(password.encode()).hexdigest()",
        "after": "def hash_password(password):     return bcrypt.hashpw(password.encode(), bcrypt.gensalt())",
        "explanation": "Bcrypt is a secure hashing algorithm that includes salting and key stretching, making it much more resistant to brute-force attacks than MD5.",
        "type": "ollama"
      },
      "owasp_id": "A02:2021",
      "owasp_name": "Cryptographic Failures",
      "owasp_url": "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
    },
    {
      "agent": "Agent B - Auth Logic Auditor (LLM)",
      "title": "Session Hijacking Vulnerability",
      "description": "The function relies on session cookies without checking the integrity of these tokens, making it susceptible to hijacking.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app.py",
      "lineno": 66,
      "code_snippet": "def login_required(f):\n    @wraps(f)\n    def decorated(*args, **kwargs):\n        if \"user_id\" not in session:\n            return jsonify({\"error\": \"Authentication required\"}), 401\n        return f(*args, **kwargs)\n    return decorated",
      "recommendation": "Implement secure cookie attributes like HttpOnly and Secure flags along with token binding or validation mechanisms such as JWTs (JSON Web Tokens).",
      "cwe_id": "CWE-703",
      "fix_suggestion": {
        "before": "def login_required(f):\n    @wraps(f)\n    def decorated(*args, **kwargs):\n        if \"user_id\" not in session:\n            return jsonify({\"error\": \"Authentication required\"}), 401\n        return f(*args, **kwargs)\n    return decorated",
        "after": "def login_required(f):     @wraps(f)     def decorated(*args, **kwargs):         if \"user_id\" not in session:             return jsonify({\"error\": \"Authentication required\"}), 401",
        "explanation": "This ensures that the user is authenticated before accessing protected routes and prevents session hijacking by checking for a valid 'user_id' token.",
        "type": "ollama"
      },
      "owasp_id": "A07:2021",
      "owasp_name": "Identification & Authentication Failures",
      "owasp_url": "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"
    },
    {
      "agent": "Agent B - Auth Logic Auditor (LLM)",
      "title": "Insecure Random Number Generation",
      "description": "The function uses a predictable random number generator for token creation, which can be easily guessed or brute forced.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app.py",
      "lineno": 75,
      "code_snippet": "def generate_reset_token(email):\n    token = str(random.randint(100000, 999999))\n    return token",
      "recommendation": "Use a cryptographically secure pseudorandom number generator (CSPRNG) to generate tokens that are unpredictable and resistant against guessing attacks.",
      "cwe_id": "CWE-26]",
      "fix_suggestion": {
        "before": "def generate_reset_token(email):\n    token = str(random.randint(100000, 999999))\n    return token",
        "after": "def generate_reset_token(email):     import secrets     return secrets.token_hex(16) + email[:8]",
        "explanation": "The `secrets` module is designed to be used when the application needs a secure random number, which makes it resistant against guessing and attacks compared to using just `random`.",
        "type": "ollama"
      },
      "owasp_id": "A02:2021",
      "owasp_name": "Cryptographic Failures",
      "owasp_url": "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
    },
    {
      "agent": "Agent C - Data Flow Analyzer",
      "title": "Unsanitized User Input Reaches conn.execute()",
      "description": "In function 'search_users', user-controlled variable(s) ['query'] flow directly into 'conn.execute()' without apparent sanitization.",
      "severity": "HIGH",
      "filepath": "demo_app\\app.py",
      "lineno": 199,
      "code_snippet": "conn.execute(\"SELECT username, email FROM users WHERE username LIKE '%\" + query + \"%'\")",
      "recommendation": "Sanitize and validate all user-supplied data before passing to database queries, OS commands, or eval-like functions. Use parameterized queries for SQL.",
      "cwe_id": "CWE-20",
      "fix_suggestion": {
        "before": "conn.execute(\"SELECT username, email FROM users WHERE username LIKE '%\" + query + \"%'\")",
        "after": "conn.execute(\"SELECT username, email FROM users WHERE username = %s\", (query,))",
        "explanation": "This uses parameterized queries with placeholders for user input instead of string concatenation which prevents SQL injection by ensuring that the query is treated as data and not executable code.",
        "type": "ollama"
      },
      "owasp_id": "A03:2021",
      "owasp_name": "Injection",
      "owasp_url": "https://owasp.org/Top10/A03_2021-Injection/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: Pillow",
      "description": "Pillow==9.0.0 may be affected by CVE-2022-22817: Pillow PIL.ImageMath.eval allows arbitrary code execution.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\requirements.txt",
      "lineno": 12,
      "code_snippet": "Pillow==9.0.0",
      "recommendation": "Upgrade Pillow to the latest patched version. Run: pip install --upgrade Pillow",
      "cwe_id": "CWE-1035",
      "fix_suggestion": {
        "before": "Pillow==9.0.0",
        "after": "# In requirements.txt \u2014 upgrade to latest secure version:\n# pip install --upgrade <package>",
        "explanation": "Upgrade this package to the latest version to patch the vulnerability.",
        "type": "rule"
      },
      "owasp_id": "A06:2021",
      "owasp_name": "Vulnerable & Outdated Components",
      "owasp_url": "https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: flask",
      "description": "flask==0.12.3 may be affected by CVE-2018-1000656: Flask before 0.12.5 is vulnerable to Denial of Service via malicious JSON data.",
      "severity": "HIGH",
      "filepath": "requirements.txt",
      "lineno": 1,
      "code_snippet": "flask==0.12.3",
      "recommendation": "Upgrade flask to the latest patched version. Run: pip install --upgrade flask",
      "cwe_id": "CWE-1035",
      "fix_suggestion": {
        "before": "flask==0.12.3",
        "after": "# In requirements.txt \u2014 upgrade to latest secure version:\n# pip install --upgrade <package>",
        "explanation": "Upgrade this package to the latest version to patch the vulnerability.",
        "type": "rule"
      },
      "owasp_id": "A06:2021",
      "owasp_name": "Vulnerable & Outdated Components",
      "owasp_url": "https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: django",
      "description": "django==2.2.0 may be affected by CVE-2022-28346: Django SQL injection vulnerability in QuerySet.annotate().",
      "severity": "CRITICAL",
      "filepath": "requirements.txt",
      "lineno": 2,
      "code_snippet": "django==2.2.0",
      "recommendation": "Upgrade django to the latest patched version. Run: pip install --upgrade django",
      "cwe_id": "CWE-1035",
      "fix_suggestion": {
        "before": "django==2.2.0",
        "after": "# In requirements.txt \u2014 upgrade to latest secure version:\n# pip install --upgrade <package>",
        "explanation": "Upgrade this package to the latest version to patch the vulnerability.",
        "type": "rule"
      },
      "owasp_id": "A03:2021",
      "owasp_name": "Injection",
      "owasp_url": "https://owasp.org/Top10/A03_2021-Injection/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: requests",
      "description": "requests==2.18.0 may be affected by CVE-2018-18074: Requests library sends HTTP Authorization header to redirected hosts.",
      "severity": "MEDIUM",
      "filepath": "requirements.txt",
      "lineno": 3,
      "code_snippet": "requests==2.18.0",
      "recommendation": "Upgrade requests to the latest patched version. Run: pip install --upgrade requests",
      "cwe_id": "CWE-1035",
      "fix_suggestion": {
        "before": "requests==2.18.0",
        "after": "# In requirements.txt \u2014 upgrade to latest secure version:\n# pip install --upgrade <package>",
        "explanation": "Upgrade this package to the latest version to patch the vulnerability.",
        "type": "rule"
      },
      "owasp_id": "A06:2021",
      "owasp_name": "Vulnerable & Outdated Components",
      "owasp_url": "https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: pillow",
      "description": "pillow==8.0.0 may be affected by CVE-2022-22817: Pillow PIL.ImageMath.eval allows arbitrary code execution.",
      "severity": "CRITICAL",
      "filepath": "requirements.txt",
      "lineno": 4,
      "code_snippet": "pillow==8.0.0",
      "recommendation": "Upgrade pillow to the latest patched version. Run: pip install --upgrade pillow",
      "cwe_id": "CWE-1035",
      "fix_suggestion": null,
      "owasp_id": "A06:2021",
      "owasp_name": "Vulnerable & Outdated Components",
      "owasp_url": "https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: pyyaml",
      "description": "pyyaml==5.3 may be affected by CVE-2020-14343: PyYAML arbitrary code execution via yaml.load() without Loader.",
      "severity": "CRITICAL",
      "filepath": "requirements.txt",
      "lineno": 5,
      "code_snippet": "pyyaml==5.3",
      "recommendation": "Upgrade pyyaml to the latest patched version. Run: pip install --upgrade pyyaml",
      "cwe_id": "CWE-1035",
      "fix_suggestion": {
        "before": "pyyaml==5.3",
        "after": "# In requirements.txt \u2014 upgrade to latest secure version:\n# pip install --upgrade <package>",
        "explanation": "Upgrade this package to the latest version to patch the vulnerability.",
        "type": "rule"
      },
      "owasp_id": "A06:2021",
      "owasp_name": "Vulnerable & Outdated Components",
      "owasp_url": "https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: sqlalchemy",
      "description": "sqlalchemy==1.3.0 may be affected by CVE-2019-7164: SQLAlchemy SQL injection via order_by() parameter.",
      "severity": "HIGH",
      "filepath": "requirements.txt",
      "lineno": 6,
      "code_snippet": "sqlalchemy==1.3.0",
      "recommendation": "Upgrade sqlalchemy to the latest patched version. Run: pip install --upgrade sqlalchemy",
      "cwe_id": "CWE-1035",
      "fix_suggestion": {
        "before": "sqlalchemy==1.3.0",
        "after": "# In requirements.txt \u2014 upgrade to latest secure version:\n# pip install --upgrade <package>",
        "explanation": "Upgrade this package to the latest version to patch the vulnerability.",
        "type": "rule"
      },
      "owasp_id": "A03:2021",
      "owasp_name": "Injection",
      "owasp_url": "https://owasp.org/Top10/A03_2021-Injection/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: jinja2",
      "description": "jinja2==2.10.0 may be affected by CVE-2020-28493: Jinja2 ReDoS vulnerability in urlize filter.",
      "severity": "MEDIUM",
      "filepath": "requirements.txt",
      "lineno": 7,
      "code_snippet": "jinja2==2.10.0",
      "recommendation": "Upgrade jinja2 to the latest patched version. Run: pip install --upgrade jinja2",
      "cwe_id": "CWE-1035",
      "fix_suggestion": {
        "before": "jinja2==2.10.0",
        "after": "# In requirements.txt \u2014 upgrade to latest secure version:\n# pip install --upgrade <package>",
        "explanation": "Upgrade this package to the latest version to patch the vulnerability.",
        "type": "rule"
      },
      "owasp_id": "A06:2021",
      "owasp_name": "Vulnerable & Outdated Components",
      "owasp_url": "https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: werkzeug",
      "description": "werkzeug==1.0.0 may be affected by CVE-2023-25577: Werkzeug multipart data parsing DoS vulnerability.",
      "severity": "HIGH",
      "filepath": "requirements.txt",
      "lineno": 8,
      "code_snippet": "werkzeug==1.0.0",
      "recommendation": "Upgrade werkzeug to the latest patched version. Run: pip install --upgrade werkzeug",
      "cwe_id": "CWE-1035",
      "fix_suggestion": {
        "before": "werkzeug==1.0.0",
        "after": "# In requirements.txt \u2014 upgrade to latest secure version:\n# pip install --upgrade <package>",
        "explanation": "Upgrade this package to the latest version to patch the vulnerability.",
        "type": "rule"
      },
      "owasp_id": "A06:2021",
      "owasp_name": "Vulnerable & Outdated Components",
      "owasp_url": "https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: numpy",
      "description": "numpy may be affected by CVE-2019-6446: NumPy pickle deserialization vulnerability via np.load().",
      "severity": "HIGH",
      "filepath": "requirements.txt",
      "lineno": 9,
      "code_snippet": "numpy",
      "recommendation": "Upgrade numpy to the latest patched version. Run: pip install --upgrade numpy",
      "cwe_id": "CWE-1035",
      "fix_suggestion": {
        "before": "numpy",
        "after": "# In requirements.txt \u2014 upgrade to latest secure version:\n# pip install --upgrade <package>",
        "explanation": "Upgrade this package to the latest version to patch the vulnerability.",
        "type": "rule"
      },
      "owasp_id": "A06:2021",
      "owasp_name": "Vulnerable & Outdated Components",
      "owasp_url": "https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Unpinned Dependency: numpy",
      "description": "numpy has no version pinned. Unpinned dependencies can introduce breaking changes or vulnerabilities automatically.",
      "severity": "LOW",
      "filepath": "requirements.txt",
      "lineno": 9,
      "code_snippet": "numpy",
      "recommendation": "Pin to a specific version: numpy==<version>. Use 'pip freeze' to get current versions.",
      "cwe_id": "CWE-1104",
      "fix_suggestion": {
        "before": "numpy",
        "after": "flask==3.0.3  # Pin to a specific secure version",
        "explanation": "Pin all dependencies to exact versions to prevent unexpected upgrades.",
        "type": "rule"
      },
      "owasp_id": "A06:2021",
      "owasp_name": "Vulnerable & Outdated Components",
      "owasp_url": "https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"
    },
    {
      "agent": "Agent E - Dependency Scanner",
      "title": "Vulnerable Dependency: urllib3",
      "description": "urllib3==1.25.0 may be affected by CVE-2021-33503: urllib3 ReDoS vulnerability in URL parsing.",
      "severity": "HIGH",
      "filepath": "requirements.txt",
      "lineno": 10,
      "code_snippet": "urllib3==1.25.0",
      "recommendation": "Upgrade urllib3 to the latest patched version. Run: pip install --upgrade urllib3",
      "cwe_id": "CWE-1035",
      "fix_suggestion": {
        "before": "urllib3==1.25.0",
        "after": "# In requirements.txt \u2014 upgrade to latest secure version:\n# pip install --upgrade <package>",
        "explanation": "Upgrade this package to the latest version to patch the vulnerability.",
        "type": "rule"
      },
      "owasp_id": "A06:2021",
      "owasp_name": "Vulnerable & Outdated Components",
      "owasp_url": "https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"
    },
    {
      "agent": "Agent F - Git History Scanner",
      "title": "Secret Key in Git History",
      "description": "A potential secret was found in commit 1f04c788 (2026-02-27) by BM840. Even if deleted from current code, this secret remains accessible in git history to anyone with repo access.",
      "severity": "HIGH",
      "filepath": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
      "lineno": null,
      "code_snippet": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\napp.secret_key = \"superSecretKey2024!\"",
      "recommendation": "1. Rotate/revoke the exposed secret immediately.\n2. Use 'git filter-repo' or BFG Repo Cleaner to purge from history.\n3. Force-push the cleaned history.\n4. Use environment variables for all secrets going forward.",
      "cwe_id": "CWE-312",
      "fix_suggestion": {
        "before": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\napp.secret_key = \"superSecretKey2024!\"",
        "after": "# Rotate this credential immediately.\n# Use: git filter-branch or BFG Repo-Cleaner to purge from history.",
        "explanation": "Rotate the exposed credential immediately and purge it from git history.",
        "type": "rule"
      },
      "owasp_id": "",
      "owasp_name": "",
      "owasp_url": ""
    },
    {
      "agent": "Agent F - Git History Scanner",
      "title": "Auth Token in Git History",
      "description": "A potential secret was found in commit 1f04c788 (2026-02-27) by BM840. Even if deleted from current code, this secret remains accessible in git history to anyone with repo access.",
      "severity": "HIGH",
      "filepath": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
      "lineno": null,
      "code_snippet": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\nADMIN_TOKEN = \"admin-token-abc123xyz\"",
      "recommendation": "1. Rotate/revoke the exposed secret immediately.\n2. Use 'git filter-repo' or BFG Repo Cleaner to purge from history.\n3. Force-push the cleaned history.\n4. Use environment variables for all secrets going forward.",
      "cwe_id": "CWE-312",
      "fix_suggestion": {
        "before": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\nADMIN_TOKEN = \"admin-token-abc123xyz\"",
        "after": "# Rotate this credential immediately.\n# Use: git filter-branch or BFG Repo-Cleaner to purge from history.",
        "explanation": "Rotate the exposed credential immediately and purge it from git history.",
        "type": "rule"
      },
      "owasp_id": "",
      "owasp_name": "",
      "owasp_url": ""
    },
    {
      "agent": "Agent F - Git History Scanner",
      "title": "API Key in Git History",
      "description": "A potential secret was found in commit 1f04c788 (2026-02-27) by BM840. Even if deleted from current code, this secret remains accessible in git history to anyone with repo access.",
      "severity": "HIGH",
      "filepath": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
      "lineno": null,
      "code_snippet": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\nSENDGRID_API_KEY = \"SG.xK9mP2nQvL8rT5wY\"",
      "recommendation": "1. Rotate/revoke the exposed secret immediately.\n2. Use 'git filter-repo' or BFG Repo Cleaner to purge from history.\n3. Force-push the cleaned history.\n4. Use environment variables for all secrets going forward.",
      "cwe_id": "CWE-312",
      "fix_suggestion": {
        "before": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\nSENDGRID_API_KEY = \"SG.xK9mP2nQvL8rT5wY\"",
        "after": "# Rotate this credential immediately.\n# Use: git filter-branch or BFG Repo-Cleaner to purge from history.",
        "explanation": "Rotate the exposed credential immediately and purge it from git history.",
        "type": "rule"
      },
      "owasp_id": "A02:2021",
      "owasp_name": "Cryptographic Failures",
      "owasp_url": "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
    },
    {
      "agent": "Agent F - Git History Scanner",
      "title": "PostgreSQL Connection String with Credentials in Git History",
      "description": "A potential secret was found in commit 1f04c788 (2026-02-27) by BM840. Even if deleted from current code, this secret remains accessible in git history to anyone with repo access.",
      "severity": "HIGH",
      "filepath": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
      "lineno": null,
      "code_snippet": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\n\"before\": \"Commit: b1cd13ae | initial commit\\n(r'postgres://[^:]+:[^@]+@',\",",
      "recommendation": "1. Rotate/revoke the exposed secret immediately.\n2. Use 'git filter-repo' or BFG Repo Cleaner to purge from history.\n3. Force-push the cleaned history.\n4. Use environment variables for all secrets going forward.",
      "cwe_id": "CWE-312",
      "fix_suggestion": {
        "before": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\n\"before\": \"Commit: b1cd13ae | initial commit\\n(r'postgres://[^:]+:[^@]+@',\",",
        "after": "# Rotate this credential immediately.\n# Use: git filter-branch or BFG Repo-Cleaner to purge from history.",
        "explanation": "Rotate the exposed credential immediately and purge it from git history.",
        "type": "rule"
      },
      "owasp_id": "",
      "owasp_name": "",
      "owasp_url": ""
    },
    {
      "agent": "Agent F - Git History Scanner",
      "title": "OpenAI API Key in Git History",
      "description": "A potential secret was found in commit 1f04c788 (2026-02-27) by BM840. Even if deleted from current code, this secret remains accessible in git history to anyone with repo access.",
      "severity": "HIGH",
      "filepath": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
      "lineno": null,
      "code_snippet": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\n\"before\": \"Commit: b1cd13ae | initial commit\\n\\\"code_snippet\\\": \\\"API_KEY = \\\\\\\"sk-abc123xyz789hardcoded\\\\\\\"\\\",\",",
      "recommendation": "1. Rotate/revoke the exposed secret immediately.\n2. Use 'git filter-repo' or BFG Repo Cleaner to purge from history.\n3. Force-push the cleaned history.\n4. Use environment variables for all secrets going forward.",
      "cwe_id": "CWE-312",
      "fix_suggestion": {
        "before": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\n\"before\": \"Commit: b1cd13ae | initial commit\\n\\\"code_snippet\\\": \\\"API_KEY = \\\\\\\"sk-abc123xyz789hardcoded\\\\\\\"\\\",\",",
        "after": "# Rotate this credential immediately.\n# Use: git filter-branch or BFG Repo-Cleaner to purge from history.",
        "explanation": "Rotate the exposed credential immediately and purge it from git history.",
        "type": "rule"
      },
      "owasp_id": "A02:2021",
      "owasp_name": "Cryptographic Failures",
      "owasp_url": "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
    },
    {
      "agent": "Agent F - Git History Scanner",
      "title": "Password in Git History",
      "description": "A potential secret was found in commit 1f04c788 (2026-02-27) by BM840. Even if deleted from current code, this secret remains accessible in git history to anyone with repo access.",
      "severity": "HIGH",
      "filepath": "C:\\Users\\royal\\OneDrive\\Desktop\\Sentinel_AI\\.git",
      "lineno": null,
      "code_snippet": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\nDB_PASSWORD = \"admin123\"",
      "recommendation": "1. Rotate/revoke the exposed secret immediately.\n2. Use 'git filter-repo' or BFG Repo Cleaner to purge from history.\n3. Force-push the cleaned history.\n4. Use environment variables for all secrets going forward.",
      "cwe_id": "CWE-312",
      "fix_suggestion": {
        "before": "Commit: 1f04c788 | feat: 9-agent AI security auditor with auto-fix engine\nDB_PASSWORD = \"admin123\"",
        "after": "# Rotate this credential immediately.\n# Use: git filter-branch or BFG Repo-Cleaner to purge from history.",
        "explanation": "Rotate the exposed credential immediately and purge it from git history.",
        "type": "rule"
      },
      "owasp_id": "",
      "owasp_name": "",
      "owasp_url": ""
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: X-Content-Type-Options",
      "description": "The 'X-Content-Type-Options' security header is not set in this file. Prevents MIME-type sniffing attacks.",
      "severity": "MEDIUM",
      "filepath": "demo_app\\app.py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add: response.headers['X-Content-Type-Options'] = 'nosniff'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-Content-Type-Options'] = '...'\n    return response",
      "cwe_id": "CWE-693",
      "fix_suggestion": {
        "before": "",
        "after": "X-Content-Type-Options: nosniff @app.before_first_request_functi",
        "explanation": "This security header tells browsers to only follow MIME types explicitly declared by HTTP headers, preventing the browser from trying to 'sniff' content and potentially executing malicious scripts.",
        "type": "ollama"
      },
      "owasp_id": "A05:2021",
      "owasp_name": "Security Misconfiguration",
      "owasp_url": "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: X-Frame-Options",
      "description": "The 'X-Frame-Options' security header is not set in this file. Prevents clickjacking by controlling iframe embedding.",
      "severity": "MEDIUM",
      "filepath": "demo_app\\app.py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add: response.headers['X-Frame-Options'] = 'DENY' or 'SAMEORIGIN'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-Frame-Options'] = '...'\n    return response",
      "cwe_id": "CWE-1021",
      "fix_suggestion": {
        "before": "",
        "after": "X-Frame-Options: DENY @app.before_first_request_functi",
        "explanation": "This security header prevents clickjacking attacks by telling browsers not to render this page in a `<frame>`, `<iframe>` or `<object>`.",
        "type": "ollama"
      },
      "owasp_id": "A05:2021",
      "owasp_name": "Security Misconfiguration",
      "owasp_url": "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: Strict-Transport-Security",
      "description": "The 'Strict-Transport-Security' security header is not set in this file. Enforces HTTPS connections (HSTS). Without this, users can be downgraded to HTTP.",
      "severity": "HIGH",
      "filepath": "demo_app\\app.py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add: response.headers['Strict-Transport-Security'] = 'max-age=31536000; includeSubDomains'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['Strict-Transport-Security'] = '...'\n    return response",
      "cwe_id": "CWE-319",
      "fix_suggestion": {
        "before": "",
        "after": "Strict-Transport-Security: max-age=31536000; includeSubDomains @app.before_first_request_functi",
        "explanation": "This security header enforces secure (HTTPS) connections and applies to all subdomains, reducing the risk of protocol downgrade attacks where an attacker forces a connection over HTTP instead of HTTPS",
        "type": "ollama"
      },
      "owasp_id": "A05:2021",
      "owasp_name": "Security Misconfiguration",
      "owasp_url": "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: Content-Security-Policy",
      "description": "The 'Content-Security-Policy' security header is not set in this file. Controls which resources the browser can load, preventing XSS attacks.",
      "severity": "HIGH",
      "filepath": "demo_app\\app.py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add a Content-Security-Policy header to restrict script/style sources.\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['Content-Security-Policy'] = '...'\n    return response",
      "cwe_id": "CWE-79",
      "fix_suggestion": {
        "before": "",
        "after": "# See recommendation above",
        "explanation": "Add a Content-Security-Policy header to restrict script/style sources.\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['Content-Security-Policy'] = '...'\n    return response",
        "type": "rule"
      },
      "owasp_id": "A05:2021",
      "owasp_name": "Security Misconfiguration",
      "owasp_url": "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: X-XSS-Protection",
      "description": "The 'X-XSS-Protection' security header is not set in this file. Enables browser XSS filter (legacy browsers).",
      "severity": "LOW",
      "filepath": "demo_app\\app.py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add: response.headers['X-XSS-Protection'] = '1; mode=block'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-XSS-Protection'] = '...'\n    return response",
      "cwe_id": "CWE-79",
      "fix_suggestion": {
        "before": "",
        "after": "# See recommendation above",
        "explanation": "Add: response.headers['X-XSS-Protection'] = '1; mode=block'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-XSS-Protection'] = '...'\n    return response",
        "type": "rule"
      },
      "owasp_id": "A05:2021",
      "owasp_name": "Security Misconfiguration",
      "owasp_url": "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"
    },
    {
      "agent": "Agent G - CORS & Headers Auditor",
      "title": "Missing Security Header: Referrer-Policy",
      "description": "The 'Referrer-Policy' security header is not set in this file. Controls how much referrer info is sent with requests.",
      "severity": "LOW",
      "filepath": "demo_app\\app.py",
      "lineno": null,
      "code_snippet": null,
      "recommendation": "Add: response.headers['Referrer-Policy'] = 'strict-origin-when-cross-origin'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['Referrer-Policy'] = '...'\n    return response",
      "cwe_id": "CWE-200",
      "fix_suggestion": {
        "before": "",
        "after": "# See recommendation above",
        "explanation": "Add: response.headers['Referrer-Policy'] = 'strict-origin-when-cross-origin'\n\nBest practice: Set all security headers globally using an @app.after_request decorator:\n\n@app.after_request\ndef set_security_headers(response):\n    response.headers['Referrer-Policy'] = '...'\n    return response",
        "type": "rule"
      },
      "owasp_id": "A05:2021",
      "owasp_name": "Security Misconfiguration",
      "owasp_url": "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"
    },
    {
      "agent": "Agent H - Cryptography Auditor",
      "title": "Weak Hash Algorithm: MD5",
      "description": "MD5 is cryptographically broken and should not be used for security purposes.",
      "severity": "HIGH",
      "filepath": "demo_app\\app.py",
      "lineno": 63,
      "code_snippet": "return hashlib.md5(password.encode()).hexdigest()",
      "recommendation": "Replace MD5 with SHA-256 or SHA-3 for general hashing.\nFor passwords, use bcrypt, argon2, or PBKDF2 via passlib:\n  from passlib.hash import bcrypt\n  hashed = bcrypt.hash(password)",
      "cwe_id": "CWE-327",
      "fix_suggestion": {
        "before": "return hashlib.md5(password.encode()).hexdigest()",
        "after": "return hashlib.sha256(password.encode()).hexdigest()",
        "explanation": "SHA-256 is a stronger hashing algorithm than MD5, providing better security against brute force attacks.",
        "type": "ollama"
      },
      "owasp_id": "A02:2021",
      "owasp_name": "Cryptographic Failures",
      "owasp_url": "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
    },
    {
      "agent": "Agent H - Cryptography Auditor",
      "title": "Insecure Random - random.randint()",
      "description": "random.randint() is not cryptographically secure. Do not use for tokens, keys, or passwords. [[!] Security-sensitive context detected]",
      "severity": "HIGH",
      "filepath": "demo_app\\app.py",
      "lineno": 76,
      "code_snippet": "token = str(random.randint(100000, 999999))",
      "recommendation": "Use the 'secrets' module for cryptographically secure randomness:\n  import secrets\n  token = secrets.token_hex(32)       # random hex string\n  token = secrets.token_urlsafe(32)   # URL-safe token\n  choice = secrets.choice(my_list)    # secure random choice",
      "cwe_id": "CWE-338",
      "fix_suggestion": {
        "before": "token = str(random.randint(100000, 999999))",
        "after": "token = ''.join(['%04d' % i for i in [random.randint(100000, 999999) for _ in range(6)]])",
        "explanation": "Using a fixed length and format ensures that the generated tokens are consistent and secure against predictability attacks.",
        "type": "ollama"
      },
      "owasp_id": "A02:2021",
      "owasp_name": "Cryptographic Failures",
      "owasp_url": "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
    },
    {
      "agent": "Agent H - Cryptography Auditor",
      "title": "SSL Certificate Verification Disabled",
      "description": "Disabling SSL certificate verification exposes the app to man-in-the-middle attacks.",
      "severity": "CRITICAL",
      "filepath": "demo_app\\app.py",
      "lineno": 147,
      "code_snippet": "verify=False",
      "recommendation": "Use ssl.PROTOCOL_TLS_CLIENT with ssl.create_default_context():\n  import ssl\n  ctx = ssl.create_default_context()\n  # This enforces TLS 1.2+, certificate verification, and hostname checking",
      "cwe_id": "CWE-295",
      "fix_suggestion": {
        "before": "verify=False",
        "after": "verify=True",
        "explanation": "Enabling SSL certificate verification is essential to prevent man-in-the-middle (MITM) attacks by validating the server's identity before establishing a connection.",
        "type": "ollama"
      },
      "owasp_id": "A02:2021",
      "owasp_name": "Cryptographic Failures",
      "owasp_url": "https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"
    }
  ]
}